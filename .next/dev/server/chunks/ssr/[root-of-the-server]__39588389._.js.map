{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///home/bangcs/Documents/tryout_tka/lib/supabase.ts"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\n\nconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL!;\nconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!;\n\nexport const supabase = createClient(supabaseUrl, supabaseAnonKey);"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM;AACN,MAAM;AAEC,MAAM,WAAW,IAAA,iRAAY,EAAC,aAAa","debugId":null}},
    {"offset": {"line": 71, "column": 0}, "map": {"version":3,"sources":["file:///home/bangcs/Documents/tryout_tka/app/history/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { supabase } from '@/lib/supabase';\n\ntype HistoryItem = {\n  id: string;\n  tryout_id: string;\n  score: number;\n  total_questions: number;\n  duration_seconds: number;\n  created_at: string;\n  tryout_title: string;\n  has_paid: boolean;\n};\n\nexport default function HistoryPage() {\n  const [history, setHistory] = useState<HistoryItem[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const router = useRouter();\n\n  useEffect(() => {\n    const fetchHistory = async () => {\n      try {\n        const { data: { session } } = await supabase.auth.getSession();\n        if (!session) {\n          router.push('/auth/login');\n          return;\n        }\n\n        // Ambil results dulu\n        const { data: results, error: resultsError } = await supabase\n          .from('results')\n          .select('id, tryout_id, score, total_questions, duration_seconds, completed_at')\n          .eq('user_id', session.user.id)\n          .order('completed_at', { ascending: false });\n\n        if (resultsError) {\n          throw resultsError;\n        }\n\n        if (!results || results.length === 0) {\n          setHistory([]);\n          setLoading(false);\n          return;\n        }\n\n        // Ambil tryout titles secara terpisah\n        const tryoutIds = [...new Set(results.map(r => r.tryout_id))];\n        const { data: tryouts, error: tryoutsError } = await supabase\n          .from('tryouts')\n          .select('id, title')\n          .in('id', tryoutIds);\n\n        if (tryoutsError) {\n          throw tryoutsError;\n        }\n\n        // Map tryout titles\n        const tryoutMap = new Map(tryouts?.map(t => [t.id, t.title]) || []);\n\n        // Transform data\n        const historyData: HistoryItem[] = results.map((item) => ({\n          id: item.id,\n          tryout_id: item.tryout_id,\n          score: item.score,\n          total_questions: item.total_questions,\n          duration_seconds: item.duration_seconds,\n          created_at: item.completed_at,\n          tryout_title: tryoutMap.get(item.tryout_id) || 'Tryout',\n          has_paid: false, // TODO: nanti tambahkan logika payment\n        }));\n\n        setHistory(historyData);\n        setLoading(false);\n      } catch (err: any) {\n        console.error('Error fetching history:', err);\n        setError(err.message || 'Gagal memuat history');\n        setLoading(false);\n      }\n    };\n\n    fetchHistory();\n  }, [router]);\n\n  const formatDate = (dateString: string) => {\n    const date = new Date(dateString);\n    return date.toLocaleDateString('id-ID', {\n      day: 'numeric',\n      month: 'long',\n      year: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit',\n    });\n  };\n\n  const formatDuration = (seconds: number) => {\n    const mins = Math.floor(seconds / 60);\n    const secs = seconds % 60;\n    return `${mins} menit ${secs} detik`;\n  };\n\n  const getScorePercentage = (score: number, total: number) => {\n    return ((score / total) * 100).toFixed(1);\n  };\n\n  const getScoreColor = (percentage: number) => {\n    if (percentage >= 80) return 'text-green-600 bg-green-50 border-green-200';\n    if (percentage >= 60) return 'text-blue-600 bg-blue-50 border-blue-200';\n    if (percentage >= 40) return 'text-yellow-600 bg-yellow-50 border-yellow-200';\n    return 'text-red-600 bg-red-50 border-red-200';\n  };\n\n  const handleViewReview = (resultId: string, tryoutId: string) => {\n    router.push(`/history/${resultId}/review?tryout_id=${tryoutId}`);\n  };\n\n  if (loading) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4\"></div>\n          <p className=\"text-gray-600\">Memuat history...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen flex items-center justify-center bg-gray-50\">\n        <div className=\"text-center bg-white p-8 rounded-lg shadow\">\n          <div className=\"text-red-600 text-5xl mb-4\">‚ö†Ô∏è</div>\n          <h2 className=\"text-xl font-bold text-gray-800 mb-2\">Gagal Memuat History</h2>\n          <p className=\"text-gray-600 mb-4\">{error}</p>\n          <button\n            onClick={() => router.push('/dashboard')}\n            className=\"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700\"\n          >\n            Kembali ke Dashboard\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 p-4\">\n      <div className=\"max-w-5xl mx-auto\">\n        {/* Header */}\n        <div className=\"mb-6\">\n          <button\n            onClick={() => router.push('/dashboard')}\n            className=\"text-blue-600 hover:text-blue-800 mb-4 flex items-center\"\n          >\n            ‚Üê Kembali ke Dashboard\n          </button>\n          <h1 className=\"text-3xl font-bold text-gray-800\">üìö History Tryout</h1>\n          <p className=\"text-gray-600 mt-2\">Lihat hasil tryout yang sudah Anda kerjakan</p>\n        </div>\n\n        {/* Stats Summary */}\n        {history.length > 0 && (\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6\">\n            <div className=\"bg-white p-4 rounded-lg shadow border-l-4 border-blue-500\">\n              <p className=\"text-gray-600 text-sm\">Total Tryout</p>\n              <p className=\"text-2xl font-bold text-blue-600\">{history.length}</p>\n            </div>\n            <div className=\"bg-white p-4 rounded-lg shadow border-l-4 border-green-500\">\n              <p className=\"text-gray-600 text-sm\">Rata-rata Skor</p>\n              <p className=\"text-2xl font-bold text-green-600\">\n                {(history.reduce((sum, item) => sum + (item.score / item.total_questions) * 100, 0) / history.length).toFixed(1)}%\n              </p>\n            </div>\n            <div className=\"bg-white p-4 rounded-lg shadow border-l-4 border-purple-500\">\n              <p className=\"text-gray-600 text-sm\">Soal Dijawab</p>\n              <p className=\"text-2xl font-bold text-purple-600\">\n                {history.reduce((sum, item) => sum + item.total_questions, 0)}\n              </p>\n            </div>\n          </div>\n        )}\n\n        {/* History List */}\n        {history.length === 0 ? (\n          <div className=\"bg-white rounded-lg shadow p-12 text-center\">\n            <div className=\"text-6xl mb-4\">üìù</div>\n            <h2 className=\"text-xl font-semibold text-gray-800 mb-2\">Belum Ada History</h2>\n            <p className=\"text-gray-600 mb-6\">Anda belum mengerjakan tryout apapun</p>\n            <button\n              onClick={() => router.push('/dashboard')}\n              className=\"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors\"\n            >\n              Mulai Tryout\n            </button>\n          </div>\n        ) : (\n          <div className=\"space-y-4\">\n            {history.map((item) => {\n              const percentage = parseFloat(getScorePercentage(item.score, item.total_questions));\n              const scoreColorClass = getScoreColor(percentage);\n\n              return (\n                <div\n                  key={item.id}\n                  className=\"bg-white rounded-lg shadow hover:shadow-lg transition-shadow border border-gray-200\"\n                >\n                  <div className=\"p-6\">\n                    <div className=\"flex flex-col md:flex-row md:items-center md:justify-between\">\n                      {/* Left Section */}\n                      <div className=\"flex-1 mb-4 md:mb-0\">\n                        <h3 className=\"text-xl font-bold text-gray-800 mb-2\">\n                          {item.tryout_title}\n                        </h3>\n                        <div className=\"flex flex-wrap gap-3 text-sm text-gray-600\">\n                          <span className=\"flex items-center\">\n                            üìÖ {formatDate(item.created_at)}\n                          </span>\n                          <span className=\"flex items-center\">\n                            ‚è±Ô∏è {formatDuration(item.duration_seconds)}\n                          </span>\n                          <span className=\"flex items-center\">\n                            üìä {item.total_questions} soal\n                          </span>\n                        </div>\n                      </div>\n\n                      {/* Right Section - Score */}\n                      <div className=\"flex items-center gap-4\">\n                        <div className={`px-6 py-3 rounded-lg border-2 ${scoreColorClass}`}>\n                          <p className=\"text-sm font-medium\">Skor Anda</p>\n                          <p className=\"text-3xl font-bold\">\n                            {item.score}/{item.total_questions}\n                          </p>\n                          <p className=\"text-sm font-medium\">{percentage}%</p>\n                        </div>\n\n                        <button\n                          onClick={() => handleViewReview(item.id, item.tryout_id)}\n                          className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2\"\n                        >\n                          <span>Lihat Review</span>\n                          <svg className=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                            <path strokeLinecap=\"round\" strokeLinejoin=\"round\" strokeWidth={2} d=\"M9 5l7 7-7 7\" />\n                          </svg>\n                        </button>\n                      </div>\n                    </div>\n\n                    {/* Progress Bar */}\n                    <div className=\"mt-4\">\n                      <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                        <div\n                          className={`h-2 rounded-full transition-all ${\n                            percentage >= 80 ? 'bg-green-500' :\n                            percentage >= 60 ? 'bg-blue-500' :\n                            percentage >= 40 ? 'bg-yellow-500' : 'bg-red-500'\n                          }`}\n                          style={{ width: `${percentage}%` }}\n                        ></div>\n                      </div>\n                    </div>\n                  </div>\n                </div>\n              );\n            })}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":"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","debugId":null}}]
}